<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="James Watson">

<title>Determinants of viral clearance in PLATCOV</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Viral_clearance_determinants_files/libs/clipboard/clipboard.min.js"></script>
<script src="Viral_clearance_determinants_files/libs/quarto-html/quarto.js"></script>
<script src="Viral_clearance_determinants_files/libs/quarto-html/popper.min.js"></script>
<script src="Viral_clearance_determinants_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Viral_clearance_determinants_files/libs/quarto-html/anchor.min.js"></script>
<link href="Viral_clearance_determinants_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Viral_clearance_determinants_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Viral_clearance_determinants_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Viral_clearance_determinants_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Viral_clearance_determinants_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="Viral_clearance_determinants_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="Viral_clearance_determinants_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Determinants of viral clearance in PLATCOV</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>James Watson </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache =</span> F, <span class="at">cache.comments =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">echo =</span> F, <span class="at">include =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.width =</span> <span class="dv">8</span>, <span class="at">fig.height =</span> <span class="dv">8</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.pos =</span> <span class="st">'H'</span>,<span class="at">dev =</span> <span class="st">'png'</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: StanHeaders</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>rstan (Version 2.21.7, GitRev: 2e1f913d3ca3)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ tibble  3.2.1     ✔ dplyr   1.1.2
✔ tidyr   1.2.1     ✔ stringr 1.5.0
✔ readr   2.1.3     ✔ forcats 0.5.2
✔ purrr   0.3.5     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract() masks rstan::extract()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()

Attaching package: 'kableExtra'


The following object is masked from 'package:dplyr':

    group_rows


Loading required package: timechange


Attaching package: 'lubridate'


The following objects are masked from 'package:base':

    date, intersect, setdiff, union


Loading required package: Matrix


Attaching package: 'Matrix'


The following objects are masked from 'package:tidyr':

    expand, pack, unpack


Loading required package: ggpubr


Attaching package: 'survminer'


The following object is masked from 'package:survival':

    myeloma



Attaching package: 'gridExtra'


The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>               _                           
platform       aarch64-apple-darwin20      
arch           aarch64                     
os             darwin20                    
system         aarch64, darwin20           
status                                     
major          4                           
minor          2.2                         
year           2022                        
month          10                          
day            31                          
svn rev        83211                       
language       R                           
version.string R version 4.2.2 (2022-10-31)
nickname       Innocent and Trusting       </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.2.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gridExtra_2.3        survminer_0.4.9      ggpubr_0.5.0        
 [4] survival_3.4-0       lme4_1.1-31          Matrix_1.5-1        
 [7] lubridate_1.9.0      timechange_0.1.1     RColorBrewer_1.1-3  
[10] finalfit_1.0.6       kableExtra_1.3.4     forcats_0.5.2       
[13] stringr_1.5.0        dplyr_1.1.2          purrr_0.3.5         
[16] readr_2.1.3          tidyr_1.2.1          tibble_3.2.1        
[19] tidyverse_1.3.2      rstan_2.21.7         ggplot2_3.4.0       
[22] StanHeaders_2.21.0-7

loaded via a namespace (and not attached):
 [1] nlme_3.1-160        matrixStats_0.63.0  fs_1.5.2           
 [4] webshot_0.5.4       httr_1.4.4          tools_4.2.2        
 [7] backports_1.4.1     utf8_1.2.3          R6_2.5.1           
[10] DBI_1.1.3           colorspace_2.0-3    withr_2.5.0        
[13] tidyselect_1.2.0    prettyunits_1.1.1   processx_3.8.0     
[16] compiler_4.2.2      cli_3.6.1           rvest_1.0.3        
[19] mice_3.15.0         xml2_1.3.3          scales_1.2.1       
[22] survMisc_0.5.6      callr_3.7.3         systemfonts_1.0.4  
[25] digest_0.6.31       minqa_1.2.5         rmarkdown_2.19     
[28] svglite_2.1.1       pkgconfig_2.0.3     htmltools_0.5.4    
[31] dbplyr_2.2.1        fastmap_1.1.0       htmlwidgets_1.6.0  
[34] rlang_1.1.0         readxl_1.4.1        rstudioapi_0.14    
[37] generics_0.1.3      zoo_1.8-11          jsonlite_1.8.4     
[40] car_3.1-1           googlesheets4_1.0.1 inline_0.3.19      
[43] magrittr_2.0.3      loo_2.5.1           Rcpp_1.0.10        
[46] munsell_0.5.0       fansi_1.0.4         abind_1.4-5        
[49] lifecycle_1.0.3     stringi_1.7.8       yaml_2.3.6         
[52] carData_3.0-5       MASS_7.3-58.1       pkgbuild_1.4.0     
[55] grid_4.2.2          parallel_4.2.2      crayon_1.5.2       
[58] lattice_0.20-45     haven_2.5.1         splines_4.2.2      
[61] hms_1.1.2           knitr_1.41          ps_1.7.2           
[64] pillar_1.9.0        boot_1.3-28         ggsignif_0.6.4     
[67] codetools_0.2-18    stats4_4.2.2        reprex_2.0.2       
[70] glue_1.6.2          evaluate_0.19       data.table_1.14.6  
[73] RcppParallel_5.1.5  modelr_0.1.10       nloptr_2.0.3       
[76] vctrs_0.6.2         tzdb_0.3.0          cellranger_1.1.0   
[79] gtable_0.3.1        km.ci_0.5-6         assertthat_0.2.1   
[82] xfun_0.35           xtable_1.8-4        broom_1.0.2        
[85] rstatix_0.7.1       googledrive_2.0.0   viridisLite_0.4.1  
[88] gargle_1.2.1        KMsurv_0.1-5        ellipsis_0.3.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkStrict(plot_serial_data): global variables used: daily_VL, ID,
log10_viral_load, Time, Timepoint_ID, Trt, trt_color</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkStrict(calculate_fever_clearance): global variables used: ID,
Time</code></pre>
</div>
</div>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data"><em>Load data</em></h2>
<p><em>Set up analysis</em></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "BR3"
[1] "LA08"
[1] "PK01"
[1] "TH1"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Missing patients in Ivermectin arm:
character(0)
Missing patients in Regeneron arm:
character(0)
Missing patients in Remdesivir arm:
character(0)
Missing patients in No study drug arm:
 [1] "PLT-BR3-031"  "PLT-BR3-092"  "PLT-BR3-094"  "PLT-BR3-096"  "PLT-LA08-007"
 [6] "PLT-LA08-008" "PLT-LA08-010" "PLT-PK01-001" "PLT-PK01-002" "PLT-PK01-006"
[11] "PLT-PK01-007" "PLT-TH1-056"  "PLT-TH1-845"  "PLT-TH1-846"  "PLT-TH1-851" 
[16] "PLT-TH1-857"  "PLT-TH1-859"  "PLT-TH1-865"  "PLT-TH1-866"  "PLT-TH1-870" 
[21] "PLT-TH1-875"  "PLT-TH1-880"  "PLT-TH1-883"  "PLT-TH1-889"  "PLT-TH1-890" 
[26] "PLT-TH1-892"  "PLT-TH1-908"  "PLT-TH1-911"  "PLT-TH1-915"  "PLT-TH1-924" 
[31] "PLT-TH1-934"  "PLT-TH1-936"  "PLT-TH1-937"  "PLT-TH1-943" 
Missing patients in Favipiravir arm:
[1] "PLT-BR3-037" "PLT-BR3-058"
Missing patients in Fluoxetine arm:
[1] "PLT-BR3-048"  "PLT-BR3-088"  "PLT-BR3-093"  "PLT-BR3-095"  "PLT-LA08-003"
[6] "PLT-PK01-003" "PLT-PK01-008"
Missing patients in Molnupiravir arm:
[1] "PLT-LA08-002"
Missing patients in Nirmatrelvir arm:
character(0)
Missing patients in Evusheld arm:
 [1] "PLT-TH1-868" "PLT-TH1-871" "PLT-TH1-876" "PLT-TH1-884" "PLT-TH1-893"
 [6] "PLT-TH1-895" "PLT-TH1-900" "PLT-TH1-904" "PLT-TH1-905" "PLT-TH1-907"
[11] "PLT-TH1-910" "PLT-TH1-912" "PLT-TH1-914" "PLT-TH1-927" "PLT-TH1-928"
[16] "PLT-TH1-944"</code></pre>
</div>
</div>
</section>
<section id="make-modified-intention-to-treat-population" class="level2">
<h2 class="anchored" data-anchor-id="make-modified-intention-to-treat-population"><em>Make modified intention to treat population</em></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               mITT population
Intervention    FALSE TRUE
  Evusheld          0   80
  Favipiravir       0  114
  Fluoxetine        2  111
  Ivermectin        2   44
  Molnupiravir      0   65
  Nirmatrelvir      0  101
  No study drug     5  203
  Regeneron         0   88
  Remdesivir        0   67</code></pre>
</div>
</div>
</section>
<section id="baseline-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="baseline-characteristics"><em>Baseline characteristics</em></h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>The following `from` values were not present in `x`: Nitazoxanide, Nirmatrelvir + Ritonavir, Ensitrelvir</code></pre>
</div>
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Dependent: Trt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">No study drug</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ivermectin</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Regeneron</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Remdesivir</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Favipiravir</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Fluoxetine</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Molnupiravir</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Nirmatrelvir</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Evusheld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Site</td>
<td style="text-align: right;">br003</td>
<td style="text-align: left;">22 (10.8)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">9 (13.4)</td>
<td style="text-align: left;">16 (14.0)</td>
<td style="text-align: right;">10 (9.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">7 (8.8)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">th001</td>
<td style="text-align: left;">176 (86.7)</td>
<td style="text-align: right;">40 (90.9)</td>
<td style="text-align: right;">84 (95.5)</td>
<td style="text-align: right;">54 (80.6)</td>
<td style="text-align: left;">96 (84.2)</td>
<td style="text-align: right;">101 (91.0)</td>
<td style="text-align: left;">65 (100.0)</td>
<td style="text-align: right;">101 (100.0)</td>
<td style="text-align: right;">73 (91.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">th057</td>
<td style="text-align: left;">3 (1.5)</td>
<td style="text-align: right;">2 (4.5)</td>
<td style="text-align: right;">1 (1.1)</td>
<td style="text-align: right;">2 (3.0)</td>
<td style="text-align: left;">2 (1.8)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">th058</td>
<td style="text-align: left;">2 (1.0)</td>
<td style="text-align: right;">2 (4.5)</td>
<td style="text-align: right;">3 (3.4)</td>
<td style="text-align: right;">2 (3.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">Mean (SD)</td>
<td style="text-align: left;">30.3 (7.7)</td>
<td style="text-align: right;">30.0 (7.0)</td>
<td style="text-align: right;">27.9 (7.3)</td>
<td style="text-align: right;">30.1 (8.2)</td>
<td style="text-align: left;">30.2 (7.5)</td>
<td style="text-align: right;">29.2 (7.7)</td>
<td style="text-align: left;">31.4 (7.4)</td>
<td style="text-align: right;">29.6 (7.3)</td>
<td style="text-align: right;">30.2 (7.9)</td>
</tr>
<tr class="even">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">Mean (SD)</td>
<td style="text-align: left;">23.1 (4.1)</td>
<td style="text-align: right;">22.3 (3.2)</td>
<td style="text-align: right;">22.1 (3.1)</td>
<td style="text-align: right;">22.7 (3.1)</td>
<td style="text-align: left;">23.1 (3.7)</td>
<td style="text-align: right;">22.1 (3.4)</td>
<td style="text-align: left;">23.1 (4.0)</td>
<td style="text-align: right;">22.7 (3.7)</td>
<td style="text-align: right;">22.3 (3.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Weight</td>
<td style="text-align: right;">Mean (SD)</td>
<td style="text-align: left;">62.5 (13.7)</td>
<td style="text-align: right;">61.6 (12.3)</td>
<td style="text-align: right;">60.4 (12.3)</td>
<td style="text-align: right;">63.9 (11.0)</td>
<td style="text-align: left;">63.0 (13.6)</td>
<td style="text-align: right;">59.2 (11.2)</td>
<td style="text-align: left;">63.4 (14.7)</td>
<td style="text-align: right;">62.0 (12.1)</td>
<td style="text-align: right;">60.6 (11.8)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Baseline.viral.load</td>
<td style="text-align: right;">Mean (SD)</td>
<td style="text-align: left;">5.4 (1.3)</td>
<td style="text-align: right;">5.6 (1.2)</td>
<td style="text-align: right;">5.6 (1.0)</td>
<td style="text-align: right;">5.5 (1.1)</td>
<td style="text-align: left;">5.5 (1.0)</td>
<td style="text-align: right;">5.6 (1.3)</td>
<td style="text-align: left;">5.6 (1.2)</td>
<td style="text-align: right;">5.4 (1.2)</td>
<td style="text-align: right;">5.4 (1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex</td>
<td style="text-align: right;">Female</td>
<td style="text-align: left;">136 (67.0)</td>
<td style="text-align: right;">24 (54.5)</td>
<td style="text-align: right;">55 (62.5)</td>
<td style="text-align: right;">35 (52.2)</td>
<td style="text-align: left;">71 (62.3)</td>
<td style="text-align: right;">78 (70.3)</td>
<td style="text-align: left;">37 (56.9)</td>
<td style="text-align: right;">65 (64.4)</td>
<td style="text-align: right;">51 (63.8)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">Male</td>
<td style="text-align: left;">67 (33.0)</td>
<td style="text-align: right;">20 (45.5)</td>
<td style="text-align: right;">33 (37.5)</td>
<td style="text-align: right;">32 (47.8)</td>
<td style="text-align: left;">43 (37.7)</td>
<td style="text-align: right;">33 (29.7)</td>
<td style="text-align: left;">28 (43.1)</td>
<td style="text-align: right;">36 (35.6)</td>
<td style="text-align: right;">29 (36.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fever_Baseline</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">158 (77.8)</td>
<td style="text-align: right;">31 (70.5)</td>
<td style="text-align: right;">66 (75.0)</td>
<td style="text-align: right;">48 (71.6)</td>
<td style="text-align: left;">88 (77.2)</td>
<td style="text-align: right;">80 (72.1)</td>
<td style="text-align: left;">52 (80.0)</td>
<td style="text-align: right;">66 (65.3)</td>
<td style="text-align: right;">60 (75.0)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">43 (21.2)</td>
<td style="text-align: right;">13 (29.5)</td>
<td style="text-align: right;">22 (25.0)</td>
<td style="text-align: right;">19 (28.4)</td>
<td style="text-align: left;">26 (22.8)</td>
<td style="text-align: right;">31 (27.9)</td>
<td style="text-align: left;">12 (18.5)</td>
<td style="text-align: right;">33 (32.7)</td>
<td style="text-align: right;">20 (25.0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">(Missing)</td>
<td style="text-align: left;">2 (1.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">1 (1.5)</td>
<td style="text-align: right;">2 (2.0)</td>
<td style="text-align: right;">0 (0.0)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variant</td>
<td style="text-align: right;">BA.1</td>
<td style="text-align: left;">13 (6.4)</td>
<td style="text-align: right;">14 (31.8)</td>
<td style="text-align: right;">15 (17.0)</td>
<td style="text-align: right;">20 (29.9)</td>
<td style="text-align: left;">21 (18.4)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">BA.2</td>
<td style="text-align: left;">52 (25.6)</td>
<td style="text-align: right;">18 (40.9)</td>
<td style="text-align: right;">30 (34.1)</td>
<td style="text-align: right;">37 (55.2)</td>
<td style="text-align: left;">42 (36.8)</td>
<td style="text-align: right;">25 (22.5)</td>
<td style="text-align: left;">5 (7.7)</td>
<td style="text-align: right;">1 (1.0)</td>
<td style="text-align: right;">1 (1.2)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">BA.2.75</td>
<td style="text-align: left;">42 (20.7)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">5 (5.7)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">5 (4.4)</td>
<td style="text-align: right;">34 (30.6)</td>
<td style="text-align: left;">27 (41.5)</td>
<td style="text-align: right;">29 (28.7)</td>
<td style="text-align: right;">30 (37.5)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">BA.4</td>
<td style="text-align: left;">2 (1.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">3 (2.6)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">2 (3.1)</td>
<td style="text-align: right;">3 (3.0)</td>
<td style="text-align: right;">0 (0.0)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">BA.5</td>
<td style="text-align: left;">41 (20.2)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">25 (28.4)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">32 (28.1)</td>
<td style="text-align: right;">29 (26.1)</td>
<td style="text-align: left;">28 (43.1)</td>
<td style="text-align: right;">25 (24.8)</td>
<td style="text-align: right;">9 (11.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">BQ.1</td>
<td style="text-align: left;">1 (0.5)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">2 (1.8)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">1 (1.0)</td>
<td style="text-align: right;">1 (1.2)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">Delta</td>
<td style="text-align: left;">10 (4.9)</td>
<td style="text-align: right;">12 (27.3)</td>
<td style="text-align: right;">13 (14.8)</td>
<td style="text-align: right;">10 (14.9)</td>
<td style="text-align: left;">11 (9.6)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">XBB</td>
<td style="text-align: left;">24 (11.8)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">8 (7.2)</td>
<td style="text-align: left;">3 (4.6)</td>
<td style="text-align: right;">25 (24.8)</td>
<td style="text-align: right;">16 (20.0)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">XBB.1.5-like</td>
<td style="text-align: left;">18 (8.9)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">13 (11.7)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: right;">17 (16.8)</td>
<td style="text-align: right;">23 (28.8)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Symptom_onset</td>
<td style="text-align: right;">Mean (SD)</td>
<td style="text-align: left;">2.1 (0.8)</td>
<td style="text-align: right;">2.3 (0.8)</td>
<td style="text-align: right;">2.2 (0.8)</td>
<td style="text-align: right;">2.4 (0.8)</td>
<td style="text-align: left;">2.1 (0.7)</td>
<td style="text-align: right;">2.1 (0.8)</td>
<td style="text-align: left;">2.1 (0.6)</td>
<td style="text-align: right;">1.9 (0.7)</td>
<td style="text-align: right;">2.0 (0.8)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vaccinated</td>
<td style="text-align: right;">No</td>
<td style="text-align: left;">1 (0.5)</td>
<td style="text-align: right;">1 (2.3)</td>
<td style="text-align: right;">3 (3.4)</td>
<td style="text-align: right;">3 (4.5)</td>
<td style="text-align: left;">2 (1.8)</td>
<td style="text-align: right;">0 (0.0)</td>
<td style="text-align: left;">1 (1.5)</td>
<td style="text-align: right;">3 (3.0)</td>
<td style="text-align: right;">1 (1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">Yes</td>
<td style="text-align: left;">202 (99.5)</td>
<td style="text-align: right;">43 (97.7)</td>
<td style="text-align: right;">85 (96.6)</td>
<td style="text-align: right;">64 (95.5)</td>
<td style="text-align: left;">112 (98.2)</td>
<td style="text-align: right;">111 (100.0)</td>
<td style="text-align: left;">64 (98.5)</td>
<td style="text-align: right;">98 (97.0)</td>
<td style="text-align: right;">79 (98.8)</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Some simple models for the baseline viral load. Which covariates best predict a high baseline viral load?</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/baseline_VL_temporal_trend-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Baseline.viral.load ~ BMI + Age + Sex + Symptom_onset + 
    Vaccinated + Variant + Site + Fever_Baseline, data = Baseline_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5736 -0.6533  0.0863  0.7843  3.0897 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          5.4633652  0.4785384  11.417  &lt; 2e-16 ***
BMI                 -0.0141376  0.0112350  -1.258 0.208609    
Age                  0.0007685  0.0052244   0.147 0.883086    
SexMale              0.1499854  0.0811984   1.847 0.065070 .  
Symptom_onset       -0.3068105  0.0536675  -5.717 1.50e-08 ***
VaccinatedYes        0.0284247  0.3112867   0.091 0.927265    
VariantBA.2          0.5137636  0.1532080   3.353 0.000833 ***
VariantBA.2.75       0.1591086  0.1589429   1.001 0.317089    
VariantBA.4          0.0410230  0.3795908   0.108 0.913964    
VariantBA.5          0.0631895  0.1576038   0.401 0.688565    
VariantBQ.1         -0.1278835  0.5213369  -0.245 0.806283    
VariantDelta        -0.1197690  0.1985635  -0.603 0.546550    
VariantXBB          -0.3214536  0.1878431  -1.711 0.087390 .  
VariantXBB.1.5-like  0.0162988  0.1910534   0.085 0.932035    
Siteth001            0.6899945  0.1530139   4.509 7.41e-06 ***
Siteth057            0.5097981  0.3972972   1.283 0.199781    
Siteth058           -0.3972052  0.4167582  -0.953 0.340817    
Fever_Baseline       0.5471707  0.0909002   6.019 2.59e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.122 on 857 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.1687,    Adjusted R-squared:  0.1523 
F-statistic: 10.23 on 17 and 857 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="all-vl-data" class="level3">
<h3 class="anchored" data-anchor-id="all-vl-data">All VL data</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/bi_exponential-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="left-versus-right-tonsil-in-the-baseline-samples" class="level3">
<h3 class="anchored" data-anchor-id="left-versus-right-tonsil-in-the-baseline-samples">left versus right tonsil in the baseline samples</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 Left Right 
 1596  1596 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Left_tonsil_1  Left_tonsil_2 Right_tonsil_1 Right_tonsil_2 
           798            798            798            798 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6718346</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6330749</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8571053</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9075873</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6702583</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5527354</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5912106</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6631594</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6697539</code></pre>
</div>
</div>
</section>
</section>
<section id="add-serology" class="level2">
<h2 class="anchored" data-anchor-id="add-serology">Add serology</h2>
<p>Add serology at days 0, 3, 7, 14.</p>
<p>Does baseline viral load correlate with baseline IgG?</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2576 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): ID
dbl (2): Day, log10_IgG

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 178 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 178 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 184 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 184 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 188 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 188 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 211 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 211 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-models" class="level2">
<h2 class="anchored" data-anchor-id="fit-models"><em>Fit models</em></h2>
<section id="naive-model-individual-fits" class="level3">
<h3 class="anchored" data-anchor-id="naive-model-individual-fits">Naive model (individual fits)</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Cannot do PLT-TH1-018
Cannot do PLT-TH1-020
Cannot do PLT-TH1-051
Cannot do PLT-TH1-105
Cannot do PLT-TH57-007
Cannot do PLT-TH1-128
Cannot do PLT-TH1-154
Cannot do PLT-BR3-026
Cannot do PLT-BR3-027
Cannot do PLT-TH1-341
Cannot do PLT-TH1-350
Cannot do PLT-TH1-388
Cannot do PLT-TH1-391
Cannot do PLT-TH1-467
Cannot do PLT-TH1-511
Cannot do PLT-TH1-566
Cannot do PLT-TH1-584
Cannot do PLT-TH1-588
Cannot do PLT-TH1-593
Cannot do PLT-BR3-076
Cannot do PLT-TH1-606
Cannot do PLT-TH1-628
Cannot do PLT-TH1-637
Cannot do PLT-TH1-672
Cannot do PLT-TH1-720
Cannot do PLT-TH1-747
Cannot do PLT-TH1-751
Cannot do PLT-TH1-777
Cannot do PLT-TH1-808
Cannot do PLT-TH1-820
Cannot do PLT-TH1-838</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/naive_model-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplots-by-treatment" class="level3">
<h3 class="anchored" data-anchor-id="boxplots-by-treatment">Boxplots by treatment</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = daily_VL ~ Trt + Study_time, data = xx)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7423 -1.0279 -0.0684  1.0391  4.1708 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      3.28910    0.09935  33.105  &lt; 2e-16 ***
TrtIvermectin    0.34315    0.24881   1.379 0.168196    
TrtRegeneron    -0.52068    0.18816  -2.767 0.005775 ** 
TrtRemdesivir   -0.83978    0.21365  -3.931 9.16e-05 ***
TrtFavipiravir  -0.01313    0.17301  -0.076 0.939521    
TrtFluoxetine   -0.14643    0.16793  -0.872 0.383465    
TrtMolnupiravir -0.75345    0.20566  -3.664 0.000264 ***
TrtNirmatrelvir -1.37130    0.17993  -7.621 6.63e-14 ***
TrtEvusheld     -0.09527    0.19770  -0.482 0.630003    
Study_time      -0.25635    0.06642  -3.860 0.000122 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.416 on 860 degrees of freedom
Multiple R-squared:  0.1465,    Adjusted R-squared:  0.1376 
F-statistic: 16.41 on 9 and 860 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="full-stan-model" class="level3">
<h3 class="anchored" data-anchor-id="full-stan-model">Full stan model</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
  14   18   18   18   22 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Full analysis dataset contains 873 patients and 15668 datapoints (13052 above LLOD, 83%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>There are a total of 873 patients in the database with a total of 15668 PCRs analysable
16.7% of samples are below LOD
check stan data formatting:</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>We are running all models with 4 chains and 2000 samples for each chain, discarding 1000 for burn-in and thining every 4, thus giving a total of 1000 posterior samples per model.</code></pre>
</div>
</div>
<p><em>main model selection</em></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/Figure_main-1.png" class="img-fluid figure-img" width="2700"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-of-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-outcomes">Analysis of outcomes</h2>
<p>We define two outcomes under the model:</p>
<ul>
<li>Peak viral load under the non-linear model</li>
<li>Rate of viral clearance under the non-linear model</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/slopes_plot-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>In No study drug the median clearance half life was 15 (range 3.2 to 40.7)
In Ivermectin the median clearance half life was 18.4 (range 9.1 to 39.8)
In Regeneron the median clearance half life was 13 (range 4.7 to 41.9)
In Remdesivir the median clearance half life was 12.8 (range 4.9 to 43.3)
In Favipiravir the median clearance half life was 16.8 (range 6.6 to 40.7)
In Fluoxetine the median clearance half life was 14 (range 4 to 33.9)
In Molnupiravir the median clearance half life was 11.5 (range 4 to 25.6)
In Nirmatrelvir the median clearance half life was 7.7 (range 3.2 to 22.9)
In Evusheld the median clearance half life was 13.1 (range 4.7 to 37.2)</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/slopes_plot-2.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>predictors of slope</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = slope_median ~ Sex + Time_since_last_dose + Study_time, 
    data = slope_out)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.48324 -0.14244  0.06347  0.21493  0.55004 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          -5.938e-01  2.355e-02 -25.210  &lt; 2e-16 ***
SexMale               2.020e-02  2.272e-02   0.889   0.3741    
Time_since_last_dose -1.820e-04  9.953e-05  -1.828   0.0678 .  
Study_time           -8.949e-02  1.437e-02  -6.230 7.31e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.32 on 860 degrees of freedom
  (9 observations deleted due to missingness)
Multiple R-squared:  0.1046,    Adjusted R-squared:  0.1015 
F-statistic: 33.48 on 3 and 860 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>very fast clearing patients in no study drug arm</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 345 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 345 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 349 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 349 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 353 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 375 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 375 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/IgG_slope_association-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>The following `from` values were not present in `x`: Age_scaled, Antibody_test, N_dose</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following `from` values were not present in `x`: Age_scaled, Antibody_test, Symptom_onset, N_dose</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/coef_plot-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fever-and-symptom-clearance" class="level1">
<h1>Fever and symptom clearance</h1>
<section id="fever" class="level2">
<h2 class="anchored" data-anchor-id="fever">fever</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 15731 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): ID
dbl (3): Time, ax_temperature, Fever_Baseline

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 342</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/fever_clearance-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/fever_clearance-2.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = clearance_time ~ t_12_med + Trt, data = temp_clearance)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7190 -0.5989 -0.3492  0.3459  5.0862 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      1.385787   0.195367   7.093 7.95e-12 ***
t_12_med         0.014419   0.008746   1.649    0.100    
TrtIvermectin   -0.014500   0.264546  -0.055    0.956    
TrtRegeneron    -0.040930   0.198066  -0.207    0.836    
TrtRemdesivir   -0.065277   0.230877  -0.283    0.778    
TrtFavipiravir  -0.170090   0.189459  -0.898    0.370    
TrtFluoxetine    0.074203   0.184369   0.402    0.688    
TrtMolnupiravir -0.235299   0.239961  -0.981    0.328    
TrtNirmatrelvir -0.260682   0.215653  -1.209    0.228    
TrtEvusheld     -0.203743   0.219869  -0.927    0.355    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9943 on 332 degrees of freedom
Multiple R-squared:  0.0299,    Adjusted R-squared:  0.003602 
F-statistic: 1.137 on 9 and 332 DF,  p-value: 0.3358</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = clearance_time ~ t_12_med, data = temp_clearance)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9367 -0.5747 -0.3772  0.3993  5.2293 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.230126   0.129143   9.525   &lt;2e-16 ***
t_12_med    0.018977   0.007643   2.483   0.0135 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9886 on 340 degrees of freedom
Multiple R-squared:  0.01781,   Adjusted R-squared:  0.01492 
F-statistic: 6.165 on 1 and 340 DF,  p-value: 0.01351</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/fever_clearance-3.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(clearance_time, clearance_time_cens) ~ 
    Trt, data = temp_clearance)

                   N Observed Expected (O-E)^2/E (O-E)^2/V
Trt=No study drug 71       71     79.3  0.864911  1.135788
Trt=Ivermectin    18       18     20.1  0.212886  0.228251
Trt=Regeneron     40       40     41.7  0.072987  0.084229
Trt=Remdesivir    26       26     25.7  0.004184  0.004562
Trt=Favipiravir   45       45     44.9  0.000357  0.000413
Trt=Fluoxetine    50       50     58.6  1.269805  1.580722
Trt=Molnupiravir  24       24     19.9  0.835951  0.894511
Trt=Nirmatrelvir  39       39     27.2  5.070598  5.578011
Trt=Evusheld      29       29     24.6  0.799727  0.866382

 Chisq= 9.3  on 8 degrees of freedom, p= 0.3 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/fever_clearance-4.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="symptoms" class="level2">
<h2 class="anchored" data-anchor-id="symptoms">Symptoms</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(Symptom_resolution, symp_censored) ~ 
    Trt, data = platcov_symp)

n=854, 19 observations deleted due to missingness.

                    N Observed Expected (O-E)^2/E (O-E)^2/V
Trt=No study drug 195      146    175.8  5.06e+00  8.69e+00
Trt=Ivermectin     43       35     33.7  4.79e-02  6.39e-02
Trt=Regeneron      88       74     73.9  6.16e-05  8.78e-05
Trt=Remdesivir     67       53     45.1  1.37e+00  1.84e+00
Trt=Favipiravir   114       92     97.2  2.77e-01  4.09e-01
Trt=Fluoxetine    110       88     93.1  2.75e-01  4.06e-01
Trt=Molnupiravir   65       55     46.0  1.75e+00  2.38e+00
Trt=Nirmatrelvir   95       78     66.8  1.90e+00  2.62e+00
Trt=Evusheld       77       64     53.4  2.12e+00  2.87e+00

 Chisq= 16.2  on 8 degrees of freedom, p= 0.04 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Viral_clearance_determinants_files/figure-html/symptom_resolution-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>